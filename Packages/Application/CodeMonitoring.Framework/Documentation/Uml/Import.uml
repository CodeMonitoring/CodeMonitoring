@startuml

User -> ImportCommandController : files
    activate ImportCommandController
    loop for each file
        ImportCommandController -> ResourceManager : importResource(file)
        ImportCommandController -> Factory : getImporterForFile(Resource)

        activate Factory
            Factory -> Factory : getParser
            activate Factory
                Factory -> Factory : getPossibleParsers
                activate Factory
                deactivate Factory
            deactivate Factory
            Factory -> Factory : getImporter
            activate Factory
                Factory -> Factory : getPossibleImporters
                activate Factory
                deactivate Factory
            deactivate Factory

            Factory -> Parser : new(Resource)
            activate Parser
            Factory -> Importer : new
            activate Importer
            Factory -> Importer : setParser(Parser)

            ImportCommandController <- Factory : importer
        deactivate Factory

        ImportCommandController -> Importer : import

        == Rest is up to the Importer ==
        loop for Importer -> Parser
            Importer <- Parser : Info
            Importer -> Importer : handleInfo(Info)
        end
    end
    deactivate ImportCommandController

@enduml
